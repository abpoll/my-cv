
\documentclass[11pt,article,oneside]{memoir}
\usepackage[english]{babel}
\usepackage{titlesec}
\usepackage{setspace}

% margins
\usepackage[left=1.5in, right=1.75in, top=1in, bottom=0.75in]{geometry}% adjust the page margins

\RequirePackage{xcolor}
\definecolor{RiceBlue}{HTML}{00205B} % official Rice blue color -- use for text etc
\definecolor{RiceGray}{HTML}{7C7E7F} % official Rice gray -- use for Section
\definecolor{LightGray}{HTML}{E0E2E6} % background color -- do not use for anything else
\definecolor{BrickRed}{HTML}{C04829} % backup colorÂ 
\definecolor{GrassGreen}{HTML}{359245}
\definecolor{WarmYellow}{HTML}{E9A139}
%% Choose fonts for use with xelatex
\usepackage{fontspec}
\setmainfont[Path=fonts/,
Mapping={tex-text},
Numbers={OldStyle},
Ligatures={Common},
UprightFont=*-Regular,
BoldFont=*-Bold,
ItalicFont=*-Italic,
BoldItalicFont=*-BoldItalic
]{CrimsonText}
\setsansfont[Path=fonts/,
Mapping=tex-text,
Colour=b31b1b,
UprightFont=*-Regular,
BoldFont=*-Bold,
ItalicFont=*-Italic]{Lato}
\setmonofont[Path=fonts/,
Mapping=tex-text,
Scale=0.9,
UprightFont=*-Regular]{Inconsolata}

%%------------------------------------------------------------------------
%% Section styling
%%------------------------------------------------------------------------

%% This includes a fudge from the following link in order to get the
%% subsection to align with a section
%% http://tex.stackexchange.com/questions/19200/titlesec-remove-space-after-empty-margin-section

\makeatletter
\newif\ifaftersec\aftersecfalse

\newcommand\setsubskip{%
    \global\aftersectrue
    \everypar{%
        \global\aftersecfalse
        \if@noskipsec
            \global\@noskipsecfalse
            \clubpenalty\@M
            \hskip-\parindent
            \begingroup
                \@svsechd\unskip{\hspace{\@tempskipb}}%
            \endgroup
        \else
            \clubpenalty\@clubpenalty\everypar{}%
        \fi}}

\newcommand\subskip{%
  \ifaftersec
     \removelastskip%         EDIT 2
     \vspace{-\baselineskip}% EDIT 2 ??????????????
  \fi
  \global\aftersecfalse}

% Section styling
\titleformat{\section}[leftmargin]{\raggedleft\sffamily\bfseries\footnotesize}{}{0pt}{}[\setsubskip]
\titlespacing*{\section}{2cm}{1ex}{0.25in}

% Subsection styling
\titleformat{\subsection}{\subskip\itshape}{}{0pt}{}[]
\titlespacing*{\subsection}{0em}{2.5ex}{1ex}

\raggedbottom
\makeatother

% useful macro
\newcommand{\dotspace}{\quad}

% better lists
\usepackage{enumitem}
\setlist[itemize, 1]{nosep, noitemsep, labelsep=-5pt, leftmargin=*, after=\vspace{\baselineskip}, itemindent=-15pt, labelindent=5pt}

% fixed width tables
\usepackage{array}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

% Use BibLaTeX
\usepackage[autostyle=true, autopunct=true, english=american]{csquotes}
\usepackage[
	backend=biber,
	style=publist,
	plauthorfirstinit=true,
	plauthorhandling=highlight,
	plnumbered=false,
	labeldateparts=false,
	boldyear=false,
	marginyear=false,
	doi=true,
	url=false,
	isbn=false,
	maxbibnames=99,
	maxcitenames=99,
  defernumbers,
  giveninits,
	date=year
]{biblatex}

\setlength{\bibhang}{15pt}

% add bib resources
((* set bibpath = data.paths.bib_path *))
((* for i in data.publications *))
\addbibresource{(((bibpath)))/(((i.file)))}
((* endfor *))

% include everything in bibliography
\nocite{*}

% bold my name
\plauthorname[James]{Doss-Gollin}

% make modifications to standard styles
\DeclareFieldFormat{title}{\mkbibquote{#1}}
\DeclareFieldFormat{url}{\url{#1}}
\DeclareFieldFormat[article]{pages}{#1}
\DeclareFieldFormat[inproceedings]{pages}{\lowercase{pp.}#1}
\DeclareFieldFormat[incollection]{pages}{\lowercase{pp.}#1}
\DeclareFieldFormat[article]{volume}{\mkbibbold{#1}}
\DeclareFieldFormat[article]{number}{\mkbibparens{#1}}
\DeclareFieldFormat[article]{url}{}
\DeclareFieldFormat{shorthandwidth}{#1}
\DeclareFieldFormat{extrayear}{}

% Remove In: for an article.
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{%
  \printtext{\bibstring{in}\intitlepunct}}}

% Format sub-bibliography headings as subsections
\defbibheading{subbibliography}[\refname]{\subsection*{#1}}

%% other stuff
% icons for the contact info
\usepackage{fontawesome5}
\usepackage{academicons}

% macros and environments
\newcommand{\Header}[1]{\\\multicolumn{3}{L{7in}}{\color{BrickRed}\Large{\spacedlowsmallcaps{#1}}}\\}
\newcommand{\Publication}[1]{\fullcite{#1} & \citeyear{#1}}
\newcommand{\CVEntry}[3]{#1 & #2 & #3}
\newenvironment{cv}
{
	\noindent\begin{longtable}{ >{\em}R{1in} L{5in} >{\em}R{0.875in} }
}{
    \end{longtable}
}

% have to load this last
\usepackage{hyperref} % Required for adding links	and customizing them
\hypersetup{colorlinks, breaklinks, urlcolor=black, linkcolor=black}

%---------------------------------------------------------------------

\begin{document}

\thispagestyle{empty}
%% Name and contact block
\noindent{
  \footnotesize
  \begin{tabular}{L{0.5\textwidth}R{0.5\textwidth}}
    (((data.person.university)))       & \texttt{\href{mailto:(((data.person.email)))}{(((data.person.email)))}} \, \faEnvelope                                                                                  \\
    (((data.person.department)))       & \texttt{\href{(((data.person.web)))}{(((data.person.web)))}} \, \faGlobe                                                                                                \\
    (((data.person.address.line1)))    & \texttt{\href{https://github.com/(((data.person.github)))}{(((data.person.github)))}} \, \faGithub                                                                      \\
    (((data.person.address.postcode))) & \texttt{\href{https://scholar.google.com/citations?user=(((data.person.googlescholar)))}{(((data.person.first_name))) (((data.person.last_name)))}} \, \aiGoogleScholar \\
  \end{tabular}
}

\bigskip

%% Name
\noindent{\LARGE\bfseries \textcolor{BrickRed}{(((data.person.first_name))) (((data.person.last_name)))}}
\reversemarginpar

\bigskip

%% Research Interests
((* set sect = data.sections | select_by_attr_name("title", "Research Interests") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.interests *))
  \item (((i.name)))
        ((* endfor *))
\end{itemize}

%% Appointments
((* set sect = data.sections | select_by_attr_name("title", "Appointments") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for univ, positions in sect.entries.items() *))
  \item \textbf{(((univ | escape_tex)))}
        ((* for pos in positions *))
        \textit{((( pos.role | escape_tex )))}, ((( pos.org | escape_tex ))), ((* if pos.start == pos.end *))((( pos.start )))((* else *))((( pos.start )))--((( pos.end )))((* endif *)).
        ((* if pos.notes *))
        ((* for note in pos.notes *))((( note | escape_tex )))((* endfor *))
        ((* endif *))
        ((* endfor *))
        ((* endfor *))
\end{itemize}

%% Education
((* set sect = data.sections | select_by_attr_name("title", "Education")*))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for univ, entry in sect.entries.items() *))
  \item \textbf{(((univ | escape_tex)))}
        ((* for deg in entry.degrees *))
        \textit{((( deg.degree | escape_tex )))}, ((( deg.subject | escape_tex ))), ((( deg.year ))).
        ((* endfor *))
        ((* if entry.notes *))((* for note in entry.notes *))
        ((( note )))
        ((* endfor *))((* endif *))
        ((* endfor *))
\end{itemize}

%% Awards
((* set sect = data.sections | select_by_attr_name("title", "Awards") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.awards | sort_by_attr(["year"], reverse=True) *))
  \item \textbf{(((i.title)))}, (((i.org))). (((i.year)))
        ((* endfor *))
\end{itemize}


%% Grants and Contracts
%((* set sect = data.sections | select_by_attr_name("title", "Grants and Contracts") *))
%\section{(((sect.title | lower)))}
%
%\mbox{}\vspace{-\dimexpr\baselineskip\relax}
%
%\begin{itemize}[label={}]
%  ((* for i in sect.entries.grants | sort_by_attr(["start"], reverse=True) *))
%  \item (((i.role)))((* if i.PI *)) (PI: (((i.PI))))((* endif *)). (((i.funder))). \enquote{(((i.title | escape_tex)))}. \$(((i.amount))). (((i.start)))--(((i.end))).
%        ((* endfor *))
%\end{itemize}

%% Publications

\section{journal articles}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}
\vspace*{-1em}

\printbibliography[type=article, heading=none]

\section{articles in review}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}
\vspace*{-1em}
\printbibliography[type=unpublished, heading=none]

\section{dissertation}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}
\vspace*{-1em}
\printbibliography[type=thesis, heading=none]

%% Invited Talks
((* set sect = data.sections | select_by_attr_name("title", "Invited Talks") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.talks | sort_by_attr(["year"], reverse=True) *))
  \item \enquote{\textbf{(((i.title | escape_tex)))}}, ((* if i.event *))(((i.event | escape_tex))), ((* endif *)) \textit{(((i.org)))}. (((i.location))). (((i.month)))((* if i.month != "May" *)).((* endif *)) (((i.year)))((* if i.coauthor *)) (with (((i.coauthor))))((* endif *)).
        ((* endfor *))
\end{itemize}

\section{conference proceedings}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}
\vspace*{-1em}
\printbibliography[type=inproceedings, heading=none]

%% Workshops
((* set sect = data.sections | select_by_attr_name("title", "Workshop Presentations") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.workshops | sort_by_attr(["year"], reverse=True) *))
  \item ((* if i.link *))\href{(((i.link)))}{\enquote{\textbf{(((i.title | escape_tex)))}}}((* else *))\enquote{\textbf{(((i.title | escape_tex)))}}((* endif *)), ((* if i.event *))(((i.event | escape_tex))), ((* endif *)) \textit{(((i.org)))}. (((i.location))). ((* if i.format *))(((i.format))).((* endif *)) (((i.month)))((* if i.month != "May" *)).((* endif *)) (((i.year)))((* if i.coauthor *)) (with (((i.coauthor))))((* endif *)).
        ((* endfor *))
\end{itemize}

%% Teaching
((* set sect = data.sections | select_by_attr_name("title", "Teaching") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\vspace{\baselineskip}

((* set courses = sect.entries.classes *))
((* for u, i in courses | groupby("university")  *))
\subsection{(((u)))}
\begin{itemize}[label={}]
  ((* for x in i | sort_first_year("year", reverse=True) *))
  \item (((x.title | escape_tex))). (((x.role))). (((x. semester))) (((x.year))).
        ((* endfor *))
\end{itemize}
((* endfor *))

%% Advising
%((* set sect = data.sections | select_by_attr_name("title", "Advising") *))
%\section{(((sect.title | lower)))}
%
%\mbox{}\vspace{-\dimexpr\baselineskip\relax}
%
%\vspace{\baselineskip}
%((* set advisees = sect.entries.advising *))
%((* for u, i in advisees | groupby("university") *))
%\subsection{(((u)))}
%\begin{itemize}[label={}]
%  ((* for x in i | sort_by_attr(["end", "start"], reverse=True) *))
%  \item (((x.name))), (((x.degree))) (((x.field))). (((x.role))). (((x.start)))--(((x.end))).
%        ((* endfor *))
%\end{itemize}
%((* endfor *))

%% Media Coverage
((* set sect = data.sections | select_by_attr_name("title", "Media Coverage") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.media | sort(attribute="date", reverse=True) *))
  \item ((* if i.url *))\href{(((i.url)))}{(((i.title)))}((* else *))i.title((* endif *)), \textit{(((i.author)))}, (((i.publication))). (((i.date))).
        ((* endfor *))
\end{itemize}

%% Workshops and sessions organized
((* set sect = data.sections | select_by_attr_name("title", "Workshops and Sessions Organized") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.convene | sort(attribute="date", reverse=True) *))
  \item \textbf{(((i.role)))}, \textit{(((i.session)))}, (((i.event))), (((i.location))). (((i.date))).
        ((* endfor *))
\end{itemize}

%% PEER REVIEW
((* set sect = data.sections | select_by_attr_name("title", "Peer Review") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.peerreview | sort(attribute="journal") *))
  \item (((i.journal | escape_tex)))
        ((* endfor *))
\end{itemize}

%% Professional Experience
((* set sect = data.sections | select_by_attr_name("title", "Professional Experience") *))
\section{(((sect.title | lower)))}

\mbox{}\vspace{-\dimexpr\baselineskip\relax}

\begin{itemize}[label={}]
  ((* for i in sect.entries.experience | sort_by_attr(["end", "start"], reverse=True) *))
  \item \textbf{(((i.title)))}, (((i.org))). ((* if i.end == i.start *))(((i.end)))((* else *))(((i.start)))--(((i.end)))((* endif *))
        ((* endfor *))
\end{itemize}



\end{document}
